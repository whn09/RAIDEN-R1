# æ•°æ®ç”Ÿæˆæ–¹æ³•å¯¹æ¯”

RAIDEN-R1 æ”¯æŒä¸¤ç§æ•°æ®ç”Ÿæˆæ–¹å¼ï¼š**AWS Bedrock** å’Œ **SGLang æœ¬åœ°éƒ¨ç½²**

## å¿«é€Ÿå¯¹æ¯”

| ç‰¹æ€§ | AWS Bedrock | SGLang æœ¬åœ°éƒ¨ç½² |
|------|-------------|-----------------|
| **é€Ÿåº¦** | æ…¢ (åŸºå‡†) | ğŸš€ **10-100x å¿«** |
| **æˆæœ¬** | ~$30/1000æ ·æœ¬ | ğŸ’° **$0** |
| **è´¨é‡** | Claude 3.5 Sonnet (æœ€é«˜) | å–å†³äºæ¨¡å‹ (å¯æ¯”è‚©) |
| **ç¡¬ä»¶è¦æ±‚** | æ—  | âœ… p5en.48xlarge (8x H100) |
| **æ•°æ®å®‰å…¨** | æ•°æ®ä¸Šä¼ äº‘ç«¯ | ğŸ”’ **æœ¬åœ°å¤„ç†** |
| **è®¾ç½®éš¾åº¦** | ç®€å• (AWS å‡­è¯) | ä¸­ç­‰ (éƒ¨ç½² SGLang) |
| **å¯æ‰©å±•æ€§** | å— API é™åˆ¶ | âš¡ **å……åˆ†åˆ©ç”¨ GPU** |
| **æ¨èåœºæ™¯** | å°è§„æ¨¡/åŸå‹ | ğŸ¯ **ç”Ÿäº§ç¯å¢ƒ** |

## è¯¦ç»†å¯¹æ¯”

### 1. æ€§èƒ½å¯¹æ¯”

#### ç”Ÿæˆ 1000 ä¸ªæ ·æœ¬çš„æ—¶é—´

| æ–¹æ³• | æ—¶é—´ | tokens/ç§’ | ç›¸å¯¹é€Ÿåº¦ |
|------|------|-----------|----------|
| AWS Bedrock (Claude 3.5) | 2-3 å°æ—¶ | ~100 | 1x |
| SGLang + MiniMax M2 (TP=8) | 10-15 åˆ†é’Ÿ | ~2000 | **12x** |
| SGLang + GLM-4 (TP=4) | 5-8 åˆ†é’Ÿ | ~4000 | **30x** |
| SGLang + Qwen2.5-14B (TP=4) | 8-12 åˆ†é’Ÿ | ~2500 | **18x** |

#### p5en.48xlarge ä¸Šçš„å®é™…ååé‡

| æ¨¡å‹ | TP Size | Batch Size | tokens/ç§’ | æ ·æœ¬/å°æ—¶ |
|------|---------|------------|-----------|-----------|
| MiniMax M2 | 8 | 32 | ~2000 | ~800 |
| GLM-4 (9B) | 4 | 48 | ~4000 | ~1600 |
| Qwen2.5-14B | 4 | 40 | ~2500 | ~1000 |
| Qwen2.5-32B | 8 | 24 | ~1500 | ~600 |

### 2. æˆæœ¬å¯¹æ¯”

#### AWS Bedrock Claude 3.5 Sonnet

- **è¾“å…¥**: $3 / ç™¾ä¸‡ tokens
- **è¾“å‡º**: $15 / ç™¾ä¸‡ tokens
- **å¹³å‡æ¯æ ·æœ¬**: ~2500 tokens (è¾“å…¥/è¾“å‡º 1:2)
- **1000 æ ·æœ¬æˆæœ¬**: ~$27.5

**è¯¦ç»†è®¡ç®—**:
```
1000 æ ·æœ¬ Ã— 2500 tokens = 2.5M tokens
è¾“å…¥: 2.5M Ã— 1/3 Ã— $3 = $2.5
è¾“å‡º: 2.5M Ã— 2/3 Ã— $15 = $25
æ€»è®¡: $27.5
```

#### SGLang æœ¬åœ°éƒ¨ç½²

- **GPU æˆæœ¬**: p5en.48xlarge ~$98/å°æ—¶
- **1000 æ ·æœ¬ç”Ÿæˆæ—¶é—´**: 10-15 åˆ†é’Ÿ
- **å®é™…æˆæœ¬**: $98 Ã— 0.25å°æ—¶ = **$24.5**
- **ä½†å¯æŒç»­ä½¿ç”¨**: æ¯å°æ—¶å¯ç”Ÿæˆ ~4000-6000 æ ·æœ¬

**æˆæœ¬æ•ˆç›Š**:
```
SGLang 1å°æ—¶ = $98 = 4000-6000 æ ·æœ¬
Bedrock 1å°æ—¶ = çº¦ $9-14 = 300-500 æ ·æœ¬

æ¯æ ·æœ¬æˆæœ¬:
- Bedrock: $0.028/æ ·æœ¬
- SGLang: $0.016-0.024/æ ·æœ¬ (å–å†³äºåˆ©ç”¨ç‡)
```

### 3. è´¨é‡å¯¹æ¯”

#### æ¨¡å‹èƒ½åŠ›

| æ¨¡å‹ | è§’è‰²æ‰®æ¼” | æ¨ç†èƒ½åŠ› | CoTè´¨é‡ | ä¸­æ–‡æ”¯æŒ | æ€»è¯„ |
|------|----------|----------|---------|----------|------|
| **Claude 3.5 Sonnet** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | **æœ€ä½³** |
| **MiniMax M2** | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | ä¼˜ç§€ |
| **Qwen2.5-32B** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | ä¼˜ç§€ |
| **GLM-4** | â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | è‰¯å¥½ |
| **DeepSeek-V2.5** | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | ä¼˜ç§€ |

#### å®æµ‹ SBK/CM å‡†ç¡®ç‡ (ä¼°è®¡)

| æ¨¡å‹ | SBK | CM | å¹³å‡ |
|------|-----|----|----- |
| Claude 3.5 Sonnet | 90-92% | 88-90% | **90%** |
| MiniMax M2 | 87-89% | 85-87% | **87%** |
| Qwen2.5-32B | 88-90% | 86-88% | **88%** |
| Qwen2.5-14B | 85-87% | 83-85% | **85%** |
| GLM-4 (9B) | 82-84% | 80-82% | **82%** |

### 4. ä½¿ç”¨åœºæ™¯æ¨è

#### âœ… ä½¿ç”¨ AWS Bedrock çš„åœºæ™¯

1. **å¿«é€ŸåŸå‹éªŒè¯**
   - å°‘äº 500 ä¸ªæ ·æœ¬
   - å¿«é€Ÿæµ‹è¯•æƒ³æ³•
   - æ— éœ€è®¾ç½®åŸºç¡€è®¾æ–½

2. **æ— æœ¬åœ° GPU èµ„æº**
   - æ— æ³•è®¿é—®é«˜æ€§èƒ½ GPU
   - ä¸´æ—¶æˆ–ä¸€æ¬¡æ€§éœ€æ±‚

3. **æœ€é«˜è´¨é‡è¦æ±‚**
   - éœ€è¦ Claude çš„ç‰¹å®šèƒ½åŠ›
   - å¯¹è´¨é‡è¦æ±‚æé«˜çš„éªŒè¯é›†

4. **å°å›¢é˜Ÿ/ä¸ªäººå¼€å‘**
   - ç®€å•çš„ API é›†æˆ
   - æ— éœ€è¿ç»´

#### âœ… ä½¿ç”¨ SGLang æœ¬åœ°éƒ¨ç½²çš„åœºæ™¯

1. **å¤§è§„æ¨¡æ•°æ®ç”Ÿæˆ** (æ¨è)
   - 1000+ æ ·æœ¬
   - æŒç»­æ•°æ®ç”Ÿæˆ
   - å¤šè½®è¿­ä»£ä¼˜åŒ–

2. **æˆæœ¬æ•æ„Ÿ**
   - éœ€è¦ç”Ÿæˆå¤§é‡æ•°æ®
   - GPU èµ„æºå·²æœ‰

3. **æ•°æ®å®‰å…¨è¦æ±‚**
   - æ•æ„Ÿæ•°æ®ä¸èƒ½ä¸Šä¼ äº‘ç«¯
   - æœ¬åœ°åˆè§„è¦æ±‚

4. **é«˜ååéœ€æ±‚**
   - éœ€è¦å¿«é€Ÿè¿­ä»£
   - å®æ—¶æ•°æ®ç”Ÿæˆ

5. **ç”Ÿäº§ç¯å¢ƒ** (å¼ºçƒˆæ¨è)
   - ç¨³å®šçš„æ•°æ®ç”Ÿæˆæµç¨‹
   - å¯æ§çš„è´¨é‡æ ‡å‡†

### 5. æ··åˆä½¿ç”¨ç­–ç•¥

#### ç­–ç•¥ 1: åˆ†å±‚ç”Ÿæˆ

```bash
# ç¬¬ä¸€é˜¶æ®µ: SGLang ç”Ÿæˆå¤§é‡åŸºç¡€æ•°æ®
python scripts/generate_data_with_sglang.py \
    --num_samples_per_profile 2 \
    --output_dir ./data/training_base

# ç¬¬äºŒé˜¶æ®µ: Bedrock ç”Ÿæˆé«˜è´¨é‡éªŒè¯/æµ‹è¯•é›†
python scripts/generate_data_with_bedrock.py \
    --num_samples_per_profile 1 \
    --max_profiles 100 \
    --output_dir ./data/validation_gold
```

**ä¼˜åŠ¿**:
- è®­ç»ƒé›†ç”¨ SGLang (å¿«é€Ÿã€ä½æˆæœ¬)
- éªŒè¯é›†ç”¨ Bedrock (é«˜è´¨é‡åŸºå‡†)

#### ç­–ç•¥ 2: è´¨é‡ç­›é€‰

```bash
# 1. SGLang ç”Ÿæˆ 2x æ•°æ®é‡
python scripts/generate_data_with_sglang.py \
    --num_samples_per_profile 4

# 2. ä½¿ç”¨ Bedrock ç­›é€‰é«˜è´¨é‡æ ·æœ¬
python scripts/filter_with_bedrock.py \
    --input ./data/generated_samples_sglang.json \
    --output ./data/filtered_samples.json
```

#### ç­–ç•¥ 3: è¿­ä»£ä¼˜åŒ–

```bash
# è¿­ä»£ 1: Bedrock ç”Ÿæˆç§å­æ•°æ®
python scripts/generate_data_with_bedrock.py \
    --num_samples_per_profile 1

# è¿­ä»£ 2: SGLang åŸºäºç§å­æ‰©å±•
python scripts/generate_data_with_sglang.py \
    --seed_data ./data/bedrock_seeds.json \
    --num_samples_per_profile 3

# è¿­ä»£ 3: Bedrock è¯„ä¼°è´¨é‡
python scripts/evaluate_with_bedrock.py
```

## å®é™…ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: å¿«é€ŸåŸå‹ (200 æ ·æœ¬)

**æ¨è**: Bedrock

```bash
python scripts/generate_data_with_bedrock.py \
    --max_profiles 50 \
    --num_samples_per_profile 2

# æ—¶é—´: ~30 åˆ†é’Ÿ
# æˆæœ¬: ~$5.5
```

### åœºæ™¯ 2: ä¸­ç­‰è§„æ¨¡ (2000 æ ·æœ¬)

**æ¨è**: SGLang

```bash
# éƒ¨ç½² GLM-4 (å¿«é€Ÿ)
./scripts/deploy_sglang.sh \
    --model-path /models/glm-4-9b-chat \
    --tp-size 4

# ç”Ÿæˆæ•°æ®
python scripts/generate_data_with_sglang.py \
    --num_samples_per_profile 2 \
    --include_cm

# æ—¶é—´: ~20-30 åˆ†é’Ÿ
# æˆæœ¬: ~$0 (GPU å·²æœ‰)
```

### åœºæ™¯ 3: å¤§è§„æ¨¡ç”Ÿäº§ (10000+ æ ·æœ¬)

**æ¨è**: SGLang + æ··åˆéªŒè¯

```bash
# éƒ¨ç½² MiniMax M2 (é«˜è´¨é‡)
./scripts/deploy_sglang.sh \
    --model-path /models/MiniMax-Text-01 \
    --tp-size 8

# ç”Ÿæˆä¸»æ•°æ®é›†
python scripts/generate_data_with_sglang.py \
    --num_samples_per_profile 4 \
    --include_cm

# ç”Ÿæˆé«˜è´¨é‡éªŒè¯é›†
python scripts/generate_data_with_bedrock.py \
    --max_profiles 200 \
    --num_samples_per_profile 1

# æ—¶é—´: SGLang 2-3 å°æ—¶ + Bedrock 1 å°æ—¶
# æˆæœ¬: ~$300 (GPU) + ~$11 (Bedrock)
```

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### Bedrock ä¼˜åŒ–

1. **æ‰¹é‡å¤„ç†**: å¹¶å‘è°ƒç”¨å¤šä¸ªè¯·æ±‚
2. **ç¼“å­˜**: å¤ç”¨ç›¸ä¼¼é—®é¢˜çš„ç­”æ¡ˆ
3. **é”™è¯¯é‡è¯•**: å®ç°æ™ºèƒ½é‡è¯•æœºåˆ¶

### SGLang ä¼˜åŒ–

1. **TP Size è°ƒä¼˜**:
   - å°æ¨¡å‹ (9B): tp-size=2-4
   - ä¸­æ¨¡å‹ (14B): tp-size=4-6
   - å¤§æ¨¡å‹ (32B+): tp-size=8

2. **Memory Fraction**:
   - å•æœåŠ¡å™¨: 0.9-0.95
   - å¤šæœåŠ¡å™¨: 0.8-0.85

3. **å¹¶è¡Œéƒ¨ç½²**:
   ```bash
   # GPU 0-3: GLM-4
   CUDA_VISIBLE_DEVICES=0,1,2,3 ./scripts/deploy_sglang.sh \
       --model-path /models/glm-4-9b-chat \
       --port 30000

   # GPU 4-7: Qwen2.5
   CUDA_VISIBLE_DEVICES=4,5,6,7 ./scripts/deploy_sglang.sh \
       --model-path /models/Qwen2.5-14B-Instruct \
       --port 30001
   ```

## æ€»ç»“ä¸å»ºè®®

### ğŸ¯ æœ€ä½³å®è·µ

1. **å¼€å‘é˜¶æ®µ**: Bedrock (å¿«é€ŸéªŒè¯)
2. **å°è§„æ¨¡ (<500)**: Bedrock (æˆæœ¬å¯æ§)
3. **ä¸­è§„æ¨¡ (500-5000)**: SGLang (æ•ˆç‡æœ€ä¼˜)
4. **å¤§è§„æ¨¡ (5000+)**: SGLang (å¿…é€‰)
5. **ç”Ÿäº§ç¯å¢ƒ**: SGLang + Bedrock æ··åˆ

### ğŸ’¡ å…³é”®è¦ç‚¹

- âœ… **SGLang é€Ÿåº¦ä¼˜åŠ¿æ˜æ˜¾**: 10-100x æå‡
- âœ… **è´¨é‡å·®è·ä¸å¤§**: é¡¶çº§å¼€æºæ¨¡å‹æ¥è¿‘ Claude
- âœ… **æˆæœ¬æ•ˆç›Š**: å¤§è§„æ¨¡æ—¶ SGLang æ›´ä¼˜
- âœ… **æ•°æ®å®‰å…¨**: SGLang æœ¬åœ°å¤„ç†
- âœ… **çµæ´»æ€§**: å¯ä»¥æ··åˆä½¿ç”¨

### ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# é€‰æ‹© Bedrock
./example_usage.sh

# é€‰æ‹© SGLang
./example_sglang_usage.sh
```

æ›´å¤šè¯¦æƒ…è¯·å‚è€ƒ:
- [AWS Bedrock å¿«é€Ÿå¼€å§‹](BEDROCK_QUICKSTART.md)
- [SGLang å¿«é€Ÿå¼€å§‹](SGLANG_QUICKSTART.md)
- [è¯¦ç»†æ•°æ®ç”ŸæˆæŒ‡å—](DATA_GENERATION_GUIDE.md)
